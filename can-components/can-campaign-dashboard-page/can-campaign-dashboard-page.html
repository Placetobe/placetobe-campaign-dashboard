<!doctype html>
<script src="../../../bower_components/moment/moment.js"></script>
<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/google-youtube/google-youtube.html">
<link rel="import" href="../../../bower_components/vimeo-video/vimeo-video.html">
<link rel="import" href="../../../bower_components/silk-editor/silk-editor.html">
<link rel="import" href="../../../bower_components/caas-campaign-types/caas-campaign-types.html">
<link rel="import" href="../can-page/can-page.html">
<link rel="import" href="../can-page-tabs/can-page-tabs.html">
<link rel="import" href="../can-campaign-stats-card/can-campaign-stats-card.html">
<link rel="import" href="../can-user-session/can-user-session.html">
<link rel="import" href="../can-login-page/can-login-page.html">
<link rel="import" href="../can-api/can-api.html">
<link rel="import" href="../can-form/can-form.html">
<link rel="import" href="../can-textinput/can-textinput.html">
<link rel="import" href="../can-textarea/can-textarea.html">
<link rel="import" href="../can-campaign-categories-list/can-campaign-categories-list.html">
<link rel="import" href="../can-campaign-cover-form/can-campaign-cover-form.html">
<link rel="import" href="../can-user-profile-form/can-user-profile-form.html">
<link rel="import" href="../can-campaign-id-form/can-campaign-id-form.html">
<link rel="import" href="../can-campaign-kvk-form/can-campaign-kvk-form.html">
<link rel="import" href="../can-campaign-contract-form/can-campaign-contract-form.html">
<link rel="import" href="../can-campaign-incentives-form/can-campaign-incentives-form.html">
<link rel="import" href="../can-contracts-table/can-contracts-table.html">
<link rel="import" href="../can-overlay/can-overlay.html">
<link rel="import" href="../can-loader/can-loader.html">
<link rel="import" href="../can-switch-button/can-switch-button.html">
<link rel="import" href="../can-campaign-repayments-card/can-campaign-repayments-card.html">
<link rel="import" href="../can-file-io/can-file-io.html">
<link rel="import" href="../can-location-selector/can-location-selector.html">
<link rel="import" href="../can-campaign-location-card/can-campaign-location-card.html">
<link rel="import" href="../can-campaign-status/can-campaign-status.html">

<dom-module id="can-campaign-dashboard-page">
    <template>

        <can-api
            auth
            id="campaignAjax"
            auto="[[loggedIn]]"
            route="entrepreneurs/[[slug]]"
            method="GET"
            last-response="{{campaign}}"
            >
        </can-api>

        <can-page
            title="Ondernemersdashboard"
            sidebar
            hidden$="[[!loggedIn]]">

            <header>
                <h1>[[campaign.projectNaam]]</h1>
            </header>

            <can-page-tabs-navigation active-tab="{{activeTab}}">
                <template is="dom-repeat" items="[[tabsdata]]">
                    <button
                        value="[[index]]"
                        disabled="[[item.isDisabled]]"
                        data-showcompletion$="[[item.requiresCompletion]]"
                        data-complete$="[[item.isComplete]]"
                        >[[item.name]]
                    </button>
                </template>
            </can-page-tabs-navigation>

            <section id="campagne-content" class="content">

                <can-page-tabs active-tab="{{activeTab}}" tabsdata="{{tabsdata}}">

                    <!-- 1. Status -->
                    <can-page-tab
                        name="Status"
                        >

                        <can-campaign-status
                            slug="[[campaign.slug]]"
                            percentage-completed="[[percentageCompleted]]">
                        </can-campaign-status>

                    </can-page-tab>

                    <!-- 1. Verhaal -->
                    <can-page-tab
                        name="Verhaal"
                        requires-completion
                        complete="[[tabOneCompleted]]"
                        >

                        <h2>Ben je er klaar voor? Begin dan met de aankleding van je campagnepagina!</h2>

                        <can-card>
                            <header>
                                <h3>Basics</h3>
                                <p>First things first. Wat is de kern van je campagne?</p>
                            </header>
                            <article>
                                <can-form
                                    auth
                                    disabled$="[[!editable]]"
                                    disabled-warning="[[notEditableWarning]]"
                                    apipath="entrepreneurs/[[campaign.id]]/basics"
                                    formdata="[[campaign]]"
                                    id="basics-form"
                                    on-error="handleBasicsError"
                                    method="put"
                                    valid="{{basicsCompleted}}"
                                    >

                                    <can-textinput
                                        name="projectNaam"
                                        value="{{campaign.projectNaam}}"
                                        placeholder="Projectnaam"
                                        pattern=".+"
                                        description="Hoe gaat je project heten? Dit hoeft niet gelijk te zijn aan je bedrijfsnaam. Idealiter heeft jouw campagnenaam niet meer dan 3 woorden."
                                        required
                                    ></can-textinput>

                                    <can-textarea
                                        name="teaser"
                                        value="{{campaign.teaser}}"
                                        placeholder="Teaser op campagneoverzicht"
                                        description="Verleid bezoekers om naar je pagina te gaan. Deze teaser komt op de overzichtenpagina te staan. (max. 140 tekens)"
                                        maxlength="140"
                                        minlength="0"
                                        required
                                    ></can-textarea>

                                    <can-textarea
                                        name="introductieTekst"
                                        value="{{campaign.introductieTekst}}"
                                        placeholder="Lead boven aan je pagina"
                                        description="Zeg in 400 tekens wie je bent, wat je doet en wat je met de campagne wil. Dit komt boven aan je tekst te staan."
                                        maxlength="400"
                                        minlength="0"
                                        required
                                    ></can-textarea>

                                </can-form>
                            </article>

                        </can-card>

                        <can-card>
                            <header>
                                <h3>Categorieën</h3>
                                <p>Zorg dat geïnteresseerden je weten te vinden. Selecteer (maximaal 3) categorieën die betrekking hebben op je campagne</p>
                            </header>
                            <article>

                                <can-form
                                    auth
                                    disabled$="[[!editable]]"
                                    disabled-warning="[[notEditableWarning]]"
                                    formdata="[[campaign]]"
                                    id="categories-form"
                                    apipath="entrepreneurs/[[campaign.id]]/categories"
                                    method="put"
                                    valid="{{categoriesCompleted}}"
                                    >

                                    <can-campaign-categories-list
                                        selected-values="{{campaign.categories}}"
                                        max-select="3"
                                    ></can-campaign-categories-list>

                                </can-form>

                            </article>
                        </can-card>

                        <can-card>
                            <header>
                                <h3>Video</h3>
                                <p> Trek aandacht met een video. Zo laat je zien wie je bent en wat je plan is. </p>
                            </header>
                            <article>

                                <can-form
                                    auth
                                    disabled$="[[!editable]]"
                                    disabled-warning="[[notEditableWarning]]"
                                    apipath="entrepreneurs/[[campaign.id]]/videourl"
                                    formdata="[[campaign.video]]"
                                    id="videourl-form"
                                    method="put"
                                    valid="{{videoCompleted}}"
                                    >

                                    <can-textinput
                                        name="videourl"
                                        value="{{campaign.video.url}}"
                                        placeholder="Vul hier de link naar je video op YouTube of Vimeo in"
                                        description="Mensen leren je kennen via video. Dus hoe persoonlijker het filmpje, hoe beter het is voor je campagne."
                                    ></can-textinput>


                                    <template is="dom-if" if="[[campaign.video.youtube.id]]" restamp="true">

                                        <google-youtube
                                            video-id="[[campaign.video.youtube.id]]"
                                            width="100%"
                                            height="400px"
                                            rel="0"
                                            start="0"
                                            autoplay="false"
                                            modestbranding="1"
                                            showinfo="0"
                                            iv_load_policy="3"
                                            rel="0"
                                        ></google-youtube>

                                    </template>

                                    <template is="dom-if" if="[[campaign.video.vimeo.id]]" restamp="true">

                                        <vimeo-video
                                            video-id="[[campaign.video.vimeo.id]]"
                                            container-width="100%"
                                        ></vimeo-video>

                                    </template>

                                </can-form>

                            </article>
                        </can-card>

                        <can-card hidden$="[[!editable]]">
                            <header>
                                <h3>Campagnetekst</h3>
                                <p>Verleid en overtuig de crowd met je verhaal.</p>
                            </header>
                            <article id="campaignText" on-tap="openTextEditor"></article>
                        </can-card>

                        <can-card>

                            <header>
                                <h3>Coverfoto</h3>
                                <p>Laat jezelf zien! Kies een duidelijke foto van jou of jullie, de ondernemer(s), waarbij je laat zien wat je doet. ({{maximumCoverFileSize}} KB)</p>
                                <ul>
                                    <li>De foto moet liggend en van goede kwaliteit zijn</li>
                                    <li>Het moet één foto zijn, geen samengevoegde foto’s</li>
                                    <li>Plak geen teksten of banners op de foto en maak geen gebruik van onnatuurlijke bewerkingen</li>
                                    <li>Houd de foto bij voorkeur in kleur</li>
                                </ul>
                                <p>Houd er rekening mee dat wanneer de foto niet aan de eisen voldoet, we jou kunnen vragen een andere foto uit te kiezen.</p>
                            </header>
                            <article>
                                <can-campaign-cover-form
                                    disabled$="[[!editable]]"
                                    disabled-warning="[[notEditableWarning]]"
                                    campaign-id="{{campaign.id}}"
                                    valid="{{coverCompleted}}"
                                    maximum-file-size="{{maximumCoverFileSize}}"
                                ></can-campaign-cover-form>
                            </article>
                        </can-card>

                        <can-card>
                            <header>
                                <h3>Social media</h3>
                                <p>Bouw een band met je achterban door ze iets meer van jezelf te laten zien. </p>
                            </header>
                            <article>
                                <can-form
                                    auth
                                    disabled$="[[!editable]]"
                                    disabled-warning="[[notEditableWarning]]"
                                    apipath="entrepreneurs/[[campaign.id]]/sociallinks"
                                    formdata="[[campaign]]"
                                    id="sociallinks-form"
                                    method="PUT"
                                    valid="{{socialCompleted}}"
                                    >
                                    <can-textinput
                                        name="facebook"
                                        value="{{campaign.facebook}}"
                                        placeholder="Facebook URL"
                                        description="Zorg ervoor dat je Facebook URL altijd begint met https://facebook.com/"
                                    >
                                    </can-textinput>
                                    <can-textinput
                                        name="twitter"
                                        value="{{campaign.twitter}}"
                                        placeholder="Twitter URL"
                                        description="Zorg ervoor dat je Twitter URL altijd begint met https://twitter.com/"
                                    >
                                    </can-textinput>
                                    <can-textinput
                                        name="linkedin"
                                        value="{{campaign.linkedin}}"
                                        placeholder="LinkedIn URL"
                                        description="Zorg ervoor dat je LinkedIn URL altijd begint met https://linkedin.com"
                                    >
                                    </can-textinput>
                                    <can-textinput
                                        name="instagram"
                                        value="{{campaign.instagram}}"
                                        placeholder="Instagram URL"
                                        description="Zorg ervoor dat je Instagram URL altijd begint met https://instagram.com/"
                                    >
                                    </can-textinput>
                                </can-form>
                            </article>
                        </can-card>

                        <can-card>

                            <can-api
                                auth
                                auto="[[loggedIn]]"
                                route="campaigns/[[slug]]/publicfiles"
                                method="GET"
                                last-response="{{publicFiles}}"
                                >
                            </can-api>

                            <header>
                                <h3>Extra documenten uploaden</h3>
                                <p>Wil je in je campagnetekst kunnen verwijzen naar extra documenten, bijvoorbeeld je bedrijfsplan? Upload dan hier de bestanden (max. 5 MB), zodat je de hyperlink kunt gebruiken in je campagnetekst.</p>
                                <ul>
                                    <li>Upload je bestand door te klikken op 'Upload bestand'.</li>
                                    <li>Klik op de bestandsnaam, hij opent in een nieuw venster.</li>
                                    <li>Kopieer de URL die in de balk bovenaan verschijnt.</li>
                                    <li>Voer deze in als hyperlink aan je campagnetekst.</li>
                                </ul>
                            </header>
                            <article class="public-files">
                                <ul>
                                    <template is="dom-repeat" items="[[publicFiles.files]]">
                                        <can-api
                                            auth
                                            auto="[[item.delete]]"
                                            route="entrepreneurs/[[slug]]/publicfiles/[[item.fileNameEncoded]]"
                                            method="DELETE"
                                            last-response="{{publicFiles}}"
                                            id="publicFile[[index]]"
                                            >
                                        </can-api>
                                        <li>
                                            <a href$="[[item.url]]" title$="[[item.fileName]]" target="_blank">[[item.fileName]]</a>
                                            <can-button remove multiple on-tap="_deletePublicFile" data-file-name="[[item.fileName]]"></can-button>
                                        </li>
                                    </template>
                                </ul>
                            </article>
                            <footer>
                                <can-file-io
                                    disabled$="[[disabled]]"
                                    disabled-warning="[[disabledWarning]]"
                                    api-route="entrepreneurs/[[slug]]/publicfiles"
                                    user-id="[[campaignId]]"
                                    download-data="{{publicFiles}}"
                                    on-upload-failed="_uploadFailed"
                                    select-button-label="upload bestand"
                                    maximum-file-size="{{maximumFileSize}}"
                                    method="POST"
                                ></can-file-io>
                            </footer>
                        </can-card>


                    </can-page-tab>

                    <can-page-tab
                        name="Financieel"
                        requires-completion
                        complete="[[tabTwoComplete]]">

                        <h2>Bouw het fundament van je campagne. Hoeveel heb je nodig? Hoe lang wil je erover doen?</h2>

                        <can-card>
                            <header>
                                <h3>Doelbedragen</h3>
                                <p>Hoeveel wil je minimaal én maximaal crowdfunden met je campagne?</p>
                            </header>
                            <article>

                                <can-form
                                    auth
                                    disabled$="[[!editable]]"
                                    disabled-warning="[[notEditableWarning]]"
                                    apipath="entrepreneurs/[[campaign.id]]/requiredandmaxfunding"
                                    id="requiredandmaxfunding-form"
                                    formdata="[[campaign]]"
                                    method="PUT"
                                    valid="{{goalsCompleted}}"
                                    on-response="_updateCampaignData"
                                    >

                                    <can-textinput
                                        name="requiredFunding"
                                        type="number"
                                        value="{{campaign.requiredFunding}}"
                                        placeholder="minimaal... (€)"
                                        min="5"
                                        pattern="([0-9])+"
                                        required>
                                    </can-textinput>

                                    <can-textinput
                                        name="maxFunding"
                                        type="number"
                                        value="{{campaign.maxFunding}}"
                                        placeholder="...en maximaal (€)"
                                        pattern="([0-9])+"
                                        description="Denk goed na over je maximale bedrag. Je moet een duidelijk plan hebben voor het geld dat je extra ophaalt. Let op: bij een leningcampagne kan het maximale bedrag niet hoger zijn dan tweemaal het minimumbedrag."
                                        min="{{campaign.requiredFunding}}"
                                        max="{{maxRequiredFunding}}"
                                        required>
                                    </can-textinput>

                                </can-form>

                            </article>

                        </can-card>

                        <can-card id="dates">
                            <header>
                                <h3>Campagnedata</h3>
                                <p>Op basis van onderstaande gegevens geven we je informatie over je aflossingsdata en -bedragen</p>
                            </header>

                            <article>

                                <can-form
                                    auth
                                    disabled$="[[!editable]]"
                                    disabled-warning="[[notEditableWarning]]"
                                    formdata="{{campaign}}"
                                    apipath="entrepreneurs/[[campaign.id]]/datesinterest"
                                    id="dates-interest-form"
                                    method="PUT"
                                    valid="{{datesCompleted}}"
                                    on-response="_updateCampaignData"
                                    >

                                    <can-textinput
                                        name="endDate"
                                        type="date"
                                        date-format="YYYY-MM-DD"
                                        min="[[today]]"
                                        max="2099-12-31"
                                        value="{{campaign.endDate}}"
                                        placeholder="einddatum van je campagne"
                                        required
                                    ></can-textinput>

                                    <template is="dom-if" if="[[isLening]]">

                                        <template is="dom-if" if="[[!isYearlyLoan]]">

                                            <can-selectbox
                                                name="annuity"
                                                value="{{campaign.annuity}}"
                                                placeholder="hoe wil je aflossen?"
                                                options="{{annuityItems}}"
                                                required
                                            ></can-selectbox>

                                        </template>

                                        <template is="dom-if" if="[[paysInTerms]]">

                                            <can-textinput
                                                name="firstPaymentDate"
                                                type="date"
                                                date-format="YYYY-MM-DD"
                                                min="[[campaign.endDate]]"
                                                max="[[campaign.finalPaymentDate]]"
                                                value="{{campaign.firstPaymentDate}}"
                                                placeholder="wanneer begin je met aflossen?"
                                                required="[[paysInTerms]]"
                                            ></can-textinput>

                                        </template>

                                        <can-textinput
                                            name="finalPaymentDate"
                                            type="date"
                                            date-format="YYYY-MM-DD"
                                            min="[[campaign.firstPaymentDate]]"
                                            max="2099-12-31"
                                            value="{{campaign.finalPaymentDate}}"
                                            placeholder="wanneer eindig je met aflossen?"
                                            required
                                        ></can-textinput>

                                        <can-textinput
                                            name="totalInterest"
                                            value="{{campaign.returnOnInvestmentPercentage}}"
                                            placeholder$="[[totalInterestLabel]]"
                                            step="0.1"
                                            pattern="^\d{1,3}(?:\.\d)?$"
                                            required
                                        ></can-textinput>

                                    </template>

                                </can-form>

                            </article>

                            <template is="dom-if" if="[[isLening]]">

                                <footer>
                                    <can-campaign-repayments-card
                                        campaign-id="[[campaign.id]]"
                                        amounts="[[repaymentAmounts]]"
                                    /></can-campaign-repayments-card>
                                </footer>

                            </template>

                        </can-card>

                        <can-card>
                            <header>
                                <h3>Investeersdersbedragen</h3>
                                <p>Wat zijn de minimale én maximale bedragen die een persoon per keer kan investeren?</p>
                            </header>
                            <article>

                                <caas-campaign-types
                                    auto-download="[[campaign.id]]"
                                    campaign-types="{{campaignTypes}}"
                                    api-endpoint="[[apiEndpoint]]"
                                    campaign-id="[[campaign.id]]"
                                    access-token=[[accessToken]]
                                    response-status={{campaignTypesResponseStatus}}>
                                </caas-campaign-types>

                                <can-form
                                    use-with-caas
                                    disabled$="[[!editable]]"
                                    disabled-warning="[[notEditableWarning]]"
                                    id="requiredFunding-form"
                                    valid="{{investAmountsCompleted}}"
                                    response-status="[[campaignTypesResponseStatus]]"
                                    on-caas-submit="_saveCampaignTypes">

                                    <template is="dom-repeat" items="{{campaignTypes}}" index-as="index">

                                        <can-textinput
                                        name="minInvestment"
                                        type="number"
                                        value="{{item.minimumInvestment::change}}"
                                        placeholder="minimaal... [[item.contractTypeName]] (€)"
                                        min="5"
                                        max="80000"
                                        pattern="([0-9])+">
                                        </can-textinput>

                                        <can-textinput
                                        name="maxInvestment"
                                        type="number"
                                        value="{{item.maximumInvestment::change}}"
                                        placeholder="... en maximaal [[item.contractTypeName]] (€)"
                                        description="Het minimale bedrag is €5, het maximale €80000."
                                        min="[[item.minimumInvestment]]"
                                        max="80000"
                                        pattern="([0-9])+">
                                        </can-textinput>

                                        <template is="dom-if" if="[[isAandelen]]">

                                            <can-textinput
                                                name="investIncrements"
                                                type="number"
                                                value="{{item.investmentIncrement::change}}"
                                                placeholder="Emissiewaarde (€)"
                                                pattern="([0-9])+"
                                                description="Dit is de waarde van 1 aandeel"
                                                min="{{item.minimumInvestment}}"
                                                max="{{item.maximumInvestment}}"
                                                required>
                                            </can-textinput>

                                        </template>

                                    </template>

                                </can-form>

                            </article>

                        </can-card>

                        <template is="dom-if" if="[[isAandelen]]">

                            <can-card>
                                <header>
                                    <h3>Aandelen</h3>
                                    <p>Vul hier de emissie waarde van 1 aandeel in.</p>
                                    <p>Het aantal te verstrekken aandelen is: doelbedrag / waarde 1 aandeel.</p>
                                </header>
                                <article>

                                    <can-form
                                        auth
                                        disabled$="[[!editable]]"
                                        disabled-warning="[[notEditableWarning]]"
                                        apipath="entrepreneurs/[[campaign.id]]/certificatepassingdate"
                                        id="certificatepassingdate-form"
                                        formdata="[[campaign]]"
                                        method="PUT"
                                        valid="{{certificatePassingDateCompleted}}"
                                        on-response="_updateCampaignData"
                                        >

                                        <can-textinput
                                            name="certificatePassingDate"
                                            type="date"
                                            date-format="YYYY-MM-DD"
                                            min="2016-01-01"
                                            max="2099-12-31"
                                            value="{{campaign.certificatePassingDate}}"
                                            description="De dag van de waarheid"
                                            placeholder="Passeerdatum van de certificaten?"
                                        ></can-textinput>

                                    </can-form>

                                </article>

                            </can-card>
                        </template>


                    </can-page-tab>

                    <can-page-tab
                        name="Gegevens"
                        requires-completion
                        complete="[[tabThreeComplete]]">

                        <h2>Vul hier de gegevens van jouw onderneming in.</h2>

                        <can-card>
                            <header>
                                <h3>Jouw onderneming</h3>
                            </header>
                            <article>

                                <can-user-profile-form
                                    user-id="[[slug]]"
                                    role="ondernemer"
                                    disabled$="[[!editable]]"
                                    disabled-warning="[[notEditableWarning]]"
                                    is-stocks-campaign="[[isAandelen]]"
                                ></can-user-profile-form>

                            </article>
                        </can-card>

                        <can-card>
                            <header>
                                <h3>Kopie ID</h3>
                                <p>Upload hier een digitale kopie van je paspoort, identiteitskaart of rijbewijs (maximum [[maximumIDFileSize]] KB)</p>
                            </header>
                            <article>
                                <can-campaign-id-form
                                    disabled$="[[!editable]]"
                                    disabled-warning="[[notEditableWarning]]"
                                    campaign-id="[[campaign.id]]"
                                    valid="{{campaignIdComplete}}"
                                    maximum-file-size="{{maximumIDFileSize}}"
                                ></can-campaign-id-form>
                            </article>

                        </can-card>

                        <can-card>
                            <header>
                                <h3>KVK uittreksel</h3>
                                <p>Upload hier een digitaal KVK uittreksel (maximum [[maximumKvkFileSize]] KB)</p>
                            </header>
                            <article>
                                <can-campaign-kvk-form
                                    disabled$="[[!editable]]"
                                    disabled-warning="[[notEditableWarning]]"
                                    campaign-id="[[campaign.id]]"
                                    valid="{{campaignKvkComplete}}"
                                    maximum-file-size="{{maximumKvkFileSize}}"
                                ></can-campaign-kvk-form>
                            </article>

                        </can-card>

                        <can-card>
                            <header>
                                <h3>Overeenkomst</h3>
                                <ul>
                                    <li>
                                        <template is="dom-if" if="[[isLening]]">
                                            <a href="https://assets.crowdaboutnow.nl/pdf/leningovereenkomst_CAN_ondernemer_V3.pdf" target="_blank">Stap 1: Download de overeenkomst</a>
                                        </template>
                                        <template is="dom-if" if="[[!isLening]]">
                                            <a href="https://assets.crowdaboutnow.nl/pdf/voorverkoopoverkeenkomst_CAN_ondernemer_V3.pdf" target="_blank">Stap 1: Download de overeenkomst</a>
                                        </template>
                                    </li>
                                    <li>Stap 2: Print, vul in en onderteken</li>
                                    <li>Stap 3: Scan de overeenkomst (duidelijk leesbaar!)</li>
                                    <li>Stap 4: Upload je getekende overeenkomst (als jpg, maximum [[maximumContractFileSize]] KB)</li>
                                </ul>
                            </header>
                            <article>
                                <can-campaign-contract-form
                                    disabled$="[[!editable]]"
                                    disabled-warning="[[notEditableWarning]]"
                                    campaign-id="[[campaign.id]]"
                                    valid="{{campaignContractComplete}}"
                                    maximum-file-size="{{maximumContractFileSize}}"
                                ></can-campaign-contract-form>
                            </article>

                        </can-card>

                    </can-page-tab>

                    <can-page-tab
                        name="Beloningen"
                        requires-completion
                        complete="[[tabFourComplete]]">

                        <h2>Hoe ga je je supporters bedanken?</h2>
                        <can-campaign-incentives-form
                            campaign-started="[[campaign.started]]"
                            disabled$="[[!editable]]"
                            disabled-warning="[[notEditableWarning]]"
                            campaignid="[[campaign.id]]"
                            contract-type-ids="[[campaign.contractTypeIds]]"
                            campaign-minimum="[[campaign.minInvestment]]"
                            campaign-maximum="[[campaign.maxInvestment]]"
                            valid="{{incentivesComplete}}"
                        ></can-campaign-incentives-form>

                    </can-page-tab>

                    <can-page-tab name="Investeringen">

                        <h2>Hier zie je alle investeerders en hoe je met ze in contact komt.</h2>

                        <can-card expandable>

                            <can-api
                                download-file
                                auth
                                content-type="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
                                id="export-excel"
                                downloaded-filename="contracts.xlsx"
                                route="entrepreneurs/[[slug]]/contracts/export/excel"
                                on-response="_excelDownloadSuccess"
                                method="GET"
                                loading="{{loadingExcel}}">
                            </can-api>

                            <header>Hier download je een overzicht van al je investeerders</header>

                            <article>
                                <can-button on-tap="_getExportExcel" hidden$="[[loadingExcel]]">Excel</can-button>
                                <can-loader hidden$="[[!loadingExcel]]" small>
                                    <h4>Bezig met laden. Een ogenblik a.u.b.</h4>
                                </can-loader>
                            </article>


                            <footer>

                            </footer>

                        </can-card>

                        <can-contracts-table campaign-id="[[campaign.id]]">
                        </can-contracts-table>

                    </can-page-tab>

                </can-page-tabs>
            </section>

            <aside>
                <can-sidebar>
                    <can-campaign-stats-card
                        campaign-id="[[campaign.id]]"
                        contract-type-id="[[activeContractId]]"
                    ></can-campaign-stats-card>


                    <can-card
                        expanded
                        hidden$="[[!campaignTypes.1]]">
                        <header>
                            <h3>Combinatie overzicht:</h3>
                            <template is="dom-repeat" items="[[campaignTypes]]" index-as="index">
                                <h4>Totaal [[item.contractTypeName]]: <can-number euros="[[item.progress]]"></can-number></h4>
                            </template>
                        </header>
                    </can-card>


                    <can-card expandable expanded>
                        <header>
                            <h3>Campagnestatus</h3>
                            <h4 hidden$="[[!campaign.started]]">Campagne loopt!</h4>
                            <h4 hidden$="[[campaign.started]]">[[campaignStatusLabel]]</h4>
                        </header>
                        <article>
                            <can-button
                                is="pushstate-anchor"
                                url="/campagnes/[[campaign.id]]"
                                target="_blank"
                                >
                                campagne bekijken
                            </can-button>
                        </article>
                    </can-card>

                    <can-card>

                        <can-api
                            auth
                            auto="[[loggedIn]]"
                            route="entrepreneurs/[[slug]]/administrativeformalities"
                            method="GET"
                            last-response="{{administrativeFormalities}}"
                            >
                        </can-api>

                        <header>
                            <h3>Campagne formaliteiten</h3>
                            <p>Onze financiële administratie houdt bij waaraan voldaan is.</p>
                        </header>
                        <article class="administrativeFormalities">
                            <ul>
                                <li completed$="[[administrativeFormalities.contractDocumentReceived]]">contract goedgekeurd</li>
                                <li completed$="[[administrativeFormalities.identificationDocumentReceived]]">ID goedgekeurd</li>
                                <li completed$="[[administrativeFormalities.KVKDocumentReceived]]">KvK uittreksel ontvangen</li>
                                <li completed$="[[administrativeFormalities.paymentReceived]]">factuur betaald</li>
                                <li completed$="[[administrativeFormalities.basicCampaignInformationApproved]]">basisgegevens goedgekeurd</li>
                            </ul>
                        </article>
                    </can-card>

                    <can-campaign-location-card
                        address="[[campaign.address]]"
                        geocode="[[campaign.geocode]]">
                            <can-button on-tap="openLocationSelector" small>Wijzig</can-button></p>
                    </can-campaign-location-card>

                </can-sidebar>
            </aside>

        </can-page>

        <can-overlay
            id="location-selector-overlay"
            with-backdrop
            no-cancel-on-outside-click
            no-cancel-on-esc-key>


            <can-api
                auth
                id="update-campaign-geocode"
                content-type="application/json"
                body="{{campaign}}"
                route="entrepreneurs/[[campaign.id]]/geocode"
                method="PUT"
                on-response="geoCodeSaved"
                on-error="geoCodeSavedError">
            </can-api>

            <can-location-selector
                geocode="{{campaign.geocode}}"
            ></can-location-selector>


            <can-button on-tap="saveGeocode">Opslaan</can-button>
            <can-button small on-tap="requestCloseLocationSelector">annuleren</can-button>
        </can-overlay>

        <can-overlay
            id="campaign-text-overlay"
            with-backdrop
            no-cancel-on-outside-click
            no-cancel-on-esc-key
            >

            <can-loader hidden$="[[!savingInterviewText]]"></can-loader>

            <can-api
                auth
                id="update-campaign-text"
                content-type="application/json"
                body='{"interview": "[[htmlInterview]]"}'
                route="entrepreneurs/[[campaign.id]]/campaigntext"
                on-request="saveInterviewText"
                on-response="interviewTextSaved"
                on-error="interviewTextSavedError"
                method="PUT">
            </can-api>

            <silk-editor
                disabled="[[savingInterviewText]]"
                resize-images
                paste-plain-text
                fixed-formatting-bar
                max-image-height="800"
                max-image-width="800"
                max-image-size="1000"
                content="[[campaign.interview]]"
                on-content-change="_handleCampaignText"
                formatting-options="bold,italics,h3,unorderedlist,orderedlist,link,image,underline,vimeo,youtube"
            ></silk-editor>
            <can-button on-tap="saveCampaignText">Opslaan</can-button>
            <can-button small on-tap="requestCloseTextEditor">annuleren</can-button>
        </can-overlay>

    </template>

    <script src="can-campaign-dashboard-page.js"></script>

</dom-module>
